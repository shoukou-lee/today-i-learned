## 멱등성

## GET
- 안전성 보장

## HEAD
- 안전성 보장

`GET` 요청의 응답에서, Response Body를 제외한 헤더와 요청줄을 응답한다.
캐싱된 리소스의 원본이 변경되었는지를 확인하는 등

## OPTIONS
해당 엔드포인트가 제공하는 HTTP 메서드들을 `Allow-*` 헤더에 응답한다.
- 안전성 보장

## POST
- 멱등성 보장하지 않음

## PATCH
- 멱등성 보장하지 않음

## PUT
- 멱등성 보장

## DELETE
- 멱등성 보장


## 마이크로서비스에서 멱등성
한 서버가 다른 서버로 요청을 보냈고, 네트워크 지연 등으로 타임아웃을 받았을 때,
해당 요청이 처리 중인지, 처리 성공 했는지 실패했는지 알 수 없다.

이러한 상황에서 멱등하지 않은 요청은 처리 결과를 알아야 하고, 처리되지 않았다면 재시도해야 한다.
멱등한 요청은 단순히 재요청을 보냈을 때, 리소스의 변경 없이 이전 처리의 결과를 받을 수 있다.


## 멱등성을 보장하지 않는 메서드를 멱등하게 구현하는 방법
HTTP 헤더 `Idempotency-Key`, unique한 특성을 가짐
서버는 Idempotency-Key와 함께 요청 내용 정보, 응답을 저장
서버는 요청을 받으면 Idempotency-Key가 저장소에 있는지 검사 후, 있다면 이전 응답을 가져와 돌려줌.

서버의 예외 상황으로,
1. 400 Bad Request 멱등키 누락 혹은 지원하지 않는 포맷
2. 409 Conflict : 처리 진행중인 멱등 키 (멱등키 DB의 상태 관리 필요성을 의미?)
3. 422 Unprocessable Entity 같은 멱등키에 다른 payload 사용
